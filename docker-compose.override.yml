# PDV Master - Docker Compose Override
# Use este arquivo para configurações específicas de desenvolvimento

version: '3.8'

services:
  # Desabilitar Redis por padrão (opcional)
  redis:
    profiles: []  # Remove do profile, sempre roda

  # Configurações de desenvolvimento para backend
  backend:
    build:
      target: development
    environment:
      # Desenvolvimento mais verboso
      NODE_ENV: development
      DEBUG_MODE: true
      LOG_LEVEL: debug
      # CORS para desenvolvimento
      CORS_ORIGIN: http://localhost:3000
    volumes:
      # Mount source code para hot reload
      - ./backend/src:/app/src
      - ./backend/package.json:/app/package.json
    command: npm run dev

  # Configurações de desenvolvimento para frontend
  frontend:
    build:
      context: .
      dockerfile: Dockerfile.frontend
      target: production  # Dockerfile só tem builder e production
    volumes:
      # Mount source code para hot reload
      - .:/app
      - /app/node_modules
    environment:
      # Ambiente desenvolvimento
      NODE_ENV: development
      VITE_API_URL: http://localhost:3001/api

  # Desenvolvimento: Expor mais portas se necessário
  postgres:
    ports:
      - "5432:5432"  # Database externo

  pgadmin:
    ports:
      - "5050:80"

# Volumes para desenvolvimento
volumes:
  postgres_data:
  redis_data:

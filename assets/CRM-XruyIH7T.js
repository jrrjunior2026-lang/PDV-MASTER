var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,n=(e,s)=>{for(var a in s||(s={}))l.call(s,a)&&r(e,a,s[a]);if(t)for(var a of t(s))i.call(s,a)&&r(e,a,s[a]);return e},c=(e,t)=>s(e,a(t)),d=(e,s,a)=>new Promise((t,l)=>{var i=e=>{try{n(a.next(e))}catch(s){l(s)}},r=e=>{try{n(a.throw(e))}catch(s){l(s)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,r);n((a=a.apply(e,s)).next())});import{c as o,r as m,S as x,j as h,B as u,C as j,k as p,f as v,I as f,_ as b}from"./index-C6XxyUR3.js";import{P as g}from"./plus-BrA5CUPw.js";import{U as y}from"./user-CsTisM80.js";
/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=o("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),C=o("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),k=o("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),w=o("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),P=()=>{const[e,s]=m.useState([]),[a,t]=m.useState([]),[l,i]=m.useState(!1),[r,o]=m.useState({}),[P,S]=m.useState(""),[z,O]=m.useState(!1);m.useEffect(()=>{L()},[]);const L=()=>d(null,null,function*(){const[e,a]=yield Promise.all([x.getCustomers(),x.getSales()]);s(e),t(a)});return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"GestÃ£o de Clientes (CRM)"}),h.jsx("p",{className:"text-slate-500",children:"Administre sua base de clientes e histÃ³rico"})]}),h.jsxs(u,{onClick:()=>i(!0),children:[h.jsx(g,{size:18})," Novo Cliente"]})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:e.map(e=>(a.reduce((e,s)=>e+(Math.random()>.8?s.total:0),0),h.jsxs(j,{className:"hover:shadow-md transition",children:[h.jsxs("div",{className:"flex items-start justify-between mb-4",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center text-slate-500",children:h.jsx(y,{size:24})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-slate-800",children:e.name}),h.jsx("p",{className:"text-xs text-slate-500",children:e.document})]})]}),e.creditLimit&&e.creditLimit>0&&h.jsxs(p,{color:"bg-emerald-100 text-emerald-700",children:["CrÃ©dito: ",v(e.creditLimit)]})]}),h.jsxs("div",{className:"space-y-2 text-sm text-slate-600",children:[e.email&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(N,{size:14})," ",e.email]}),e.phone&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(k,{size:14})," ",e.phone]}),e.address&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(C,{size:14})," ",e.address]})]}),h.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 flex items-center justify-between",children:[h.jsxs("div",{className:"text-xs text-slate-500",children:["Ãšltima compra: ",h.jsx("span",{className:"font-semibold text-slate-700",children:"HÃ¡ 2 dias"})]}),h.jsxs("button",{onClick:()=>{return s=e.name,d(null,null,function*(){O(!0),S(""),yield b(()=>import("./geminiService-D8wDBU1b.js"),[]).then(e=>e.GeminiService),O(!1),S(`OlÃ¡ ${s}! ðŸŒŸ Notamos que vocÃª adora nossas promoÃ§Ãµes. Que tal conferir as ofertas de Arroz e FeijÃ£o hoje? Venha para o PDV MASTER!`)});var s},className:"text-xs flex items-center gap-1 text-brand-600 hover:text-brand-700 font-medium",children:[h.jsx(w,{size:14})," Marketing"]})]}),P&&P.includes(e.name)&&h.jsxs("div",{className:"mt-3 bg-brand-50 p-3 rounded-lg text-xs text-brand-800 italic animate-fadeIn",children:['"',P,'"']})]},e.id)))}),l&&h.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg p-6",children:[h.jsx("h3",{className:"text-xl font-bold mb-4",children:"Cadastrar Cliente"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(f,{label:"Nome Completo",value:r.name||"",onChange:e=>o(c(n({},r),{name:e.target.value}))}),h.jsx(f,{label:"CPF / CNPJ",value:r.document||"",onChange:e=>o(c(n({},r),{document:e.target.value}))}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsx(f,{label:"Email",value:r.email||"",onChange:e=>o(c(n({},r),{email:e.target.value}))}),h.jsx(f,{label:"Telefone",value:r.phone||"",onChange:e=>o(c(n({},r),{phone:e.target.value}))})]}),h.jsx(f,{label:"EndereÃ§o",value:r.address||"",onChange:e=>o(c(n({},r),{address:e.target.value}))}),h.jsx(f,{label:"Limite de CrÃ©dito (R$)",type:"number",value:r.creditLimit,onChange:e=>o(c(n({},r),{creditLimit:parseFloat(e.target.value)}))})]}),h.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[h.jsx(u,{variant:"secondary",onClick:()=>i(!1),children:"Cancelar"}),h.jsx(u,{onClick:()=>d(null,null,function*(){if(!r.name||!r.document)return;const e={id:crypto.randomUUID(),name:r.name,document:r.document,email:r.email||"",phone:r.phone||"",address:r.address||"",creditLimit:Number(r.creditLimit||0)};yield x.saveCustomer(e),i(!1),o({}),L()}),children:"Salvar Cliente"})]})]})})]})};export{P as CRM};

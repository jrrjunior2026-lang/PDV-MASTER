var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,d=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;import{c,r as i,j as n,C as x,I as o,B as p,f as m,S as h,P as j}from"./index-C7dkUxDe.js";import{F as b,C as N}from"./csvService-U3vRcpp7.js";import{C as y}from"./calendar-QwY-UEWf.js";import{P as u}from"./printer-Ddvnzz9b.js";import{D as g}from"./dollar-sign-CQax7-vZ.js";
/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f=c("chart-no-axes-column",[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]]),S=c("coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),v=()=>{var e;const[c,v]=i.useState("SALES"),[C,k]=i.useState(new Date((new Date).setDate(1)).toISOString().split("T")[0]),[w,O]=i.useState((new Date).toISOString().split("T")[0]),[I,T]=i.useState([]),[E,D]=i.useState({}),A=()=>{return e=null,i=null,n=function*(){const e=new Date(C);e.setHours(0,0,0,0);const i=new Date(w);switch(i.setHours(23,59,59,999),c){case"SALES":const c=yield h.getSalesByPeriod(e.toISOString(),i.toISOString());T(c),D({total:c.reduce((e,t)=>e+t.total,0),count:c.length});break;case"STOCK_POSITION":const n=yield h.getProducts();T(n),D({costValue:n.reduce((e,t)=>e+t.cost*t.stock,0),saleValue:n.reduce((e,t)=>e+t.price*t.stock,0),itemCount:n.length});break;case"CASH_CLOSING":const x=yield h.getClosedRegisters(),o=yield h.getAllCashTransactions(),p=x.map(e=>{const c=o.filter(t=>t.registerId===e.id).filter(e=>"SALE"===e.type).reduce((e,t)=>e+t.amount,0);return i=((e,t)=>{for(var s in t||(t={}))l.call(t,s)&&d(e,s,t[s]);if(a)for(var s of a(t))r.call(t,s)&&d(e,s,t[s]);return e})({},e),t(i,s({sales:c}));var i});T(p);break;case"FINANCIAL_STATEMENT":const m=(yield h.getFinancialRecords()).filter(t=>{const s=new Date(t.date);return s>=e&&s<=i});T(m),D({income:m.filter(e=>"INCOME"===e.type).reduce((e,t)=>e+t.amount,0),expense:m.filter(e=>"EXPENSE"===e.type).reduce((e,t)=>e+t.amount,0)})}},new Promise((t,s)=>{var a=e=>{try{r(n.next(e))}catch(t){s(t)}},l=e=>{try{r(n.throw(e))}catch(t){s(t)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,l);r((n=n.apply(e,i)).next())});var e,i,n};i.useEffect(()=>{A()},[c,C,w]);const P=[{id:"SALES",label:"Vendas por Período",icon:n.jsx(g,{size:20})},{id:"STOCK_POSITION",label:"Posição de Estoque",icon:n.jsx(j,{size:20})},{id:"CASH_CLOSING",label:"Fechamentos de Caixa",icon:n.jsx(S,{size:20})},{id:"FINANCIAL_STATEMENT",label:"Extrato Financeiro",icon:n.jsx(f,{size:20})}];return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Relatórios Gerenciais"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[n.jsx("div",{className:"md:col-span-1 space-y-2",children:P.map(e=>n.jsxs("button",{onClick:()=>v(e.id),className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-all text-left "+(c===e.id?"bg-brand-50 text-brand-700 border border-brand-200 shadow-sm":"bg-white text-slate-600 hover:bg-slate-50 border border-transparent"),children:[e.icon,e.label]},e.id))}),n.jsx("div",{className:"md:col-span-3",children:n.jsxs(x,{className:"p-0 overflow-hidden",children:[n.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-200 flex flex-wrap justify-between items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(y,{size:18,className:"text-slate-500"}),n.jsx(o,{type:"date",value:C,onChange:e=>k(e.target.value),className:"text-sm py-1"}),n.jsx("span",{className:"text-slate-500",children:"até"}),n.jsx(o,{type:"date",value:w,onChange:e=>O(e.target.value),className:"text-sm py-1"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(p,{variant:"secondary",onClick:()=>{window.print()},children:[n.jsx(u,{size:16})," Imprimir"]}),n.jsxs(p,{variant:"secondary",onClick:()=>{const e=`relatorio_${c.toLowerCase()}_${(new Date).toISOString().split("T")[0]}`;let t=[];switch(c){case"SALES":t=[{label:"ID",key:"id"},{label:"Data",key:"date"},{label:"Total",key:"total"},{label:"Pagamento",key:"paymentMethod"}];break;case"STOCK_POSITION":t=[{label:"Código",key:"code"},{label:"Nome",key:"name"},{label:"Estoque",key:"stock"},{label:"Custo",key:"cost"},{label:"Venda",key:"price"}]}N.exportToCsv(I,t,e)},children:[n.jsx(b,{size:16})," Exportar CSV"]})]})]}),n.jsxs("div",{id:"printable-area",className:"p-6",children:[n.jsx("h2",{className:"text-xl font-bold mb-4 print:text-black",children:null==(e=P.find(e=>e.id===c))?void 0:e.label}),"SALES"===c&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"mb-4 p-4 bg-brand-50 rounded-lg border border-brand-100 text-center",children:[n.jsx("p",{className:"text-sm text-brand-700",children:"Total Vendido no Período:"}),n.jsx("p",{className:"text-3xl font-bold text-brand-800",children:m(E.total||0)}),n.jsxs("p",{className:"text-xs text-brand-600",children:["(",E.count," vendas)"]})]}),n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"text-xs text-slate-500 uppercase bg-slate-100",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left",children:"Data"}),n.jsx("th",{className:"px-4 py-2 text-left",children:"Itens"}),n.jsx("th",{className:"px-4 py-2 text-right",children:"Total"})]})}),n.jsx("tbody",{className:"divide-y divide-slate-100",children:I.map(e=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2",children:new Date(e.date).toLocaleString()}),n.jsx("td",{className:"px-4 py-2",children:e.items?e.items.length:0}),n.jsx("td",{className:"px-4 py-2 text-right font-bold",children:m(e.total)})]},e.id))})]})]}),"STOCK_POSITION"===c&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-100 text-center",children:[n.jsx("p",{className:"text-sm text-blue-700",children:"Valor de Custo Total:"}),n.jsx("p",{className:"text-2xl font-bold text-blue-800",children:m(E.costValue||0)})]}),n.jsxs("div",{className:"p-4 bg-emerald-50 rounded-lg border border-emerald-100 text-center",children:[n.jsx("p",{className:"text-sm text-emerald-700",children:"Valor de Venda Total:"}),n.jsx("p",{className:"text-2xl font-bold text-emerald-800",children:m(E.saleValue||0)})]})]}),n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"text-xs text-slate-500 uppercase bg-slate-100",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left",children:"Produto"}),n.jsx("th",{className:"px-4 py-2 text-right",children:"Estoque"}),n.jsx("th",{className:"px-4 py-2 text-right",children:"Vl. Custo"}),n.jsx("th",{className:"px-4 py-2 text-right",children:"Vl. Venda"})]})}),n.jsx("tbody",{className:"divide-y divide-slate-100",children:I.map(e=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:e.name}),n.jsxs("td",{className:"px-4 py-2 text-right font-bold",children:[e.stock," ",e.unit]}),n.jsx("td",{className:"px-4 py-2 text-right",children:m(e.stock*e.cost)}),n.jsx("td",{className:"px-4 py-2 text-right",children:m(e.stock*e.price)})]},e.id))})]})]}),"CASH_CLOSING"===c&&n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"text-xs text-slate-500 uppercase bg-slate-100",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left",children:"Data Fechamento"}),n.jsx("th",{className:"px-4 py-2 text-right",children:"Sistema"}),n.jsx("th",{className:"px-4 py-2 text-right",children:"Contado"}),n.jsx("th",{className:"px-4 py-2 text-right",children:"Diferença"})]})}),n.jsx("tbody",{className:"divide-y divide-slate-100",children:I.map(e=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2",children:new Date(e.closedAt).toLocaleString()}),n.jsx("td",{className:"px-4 py-2 text-right",children:m(e.currentBalance)}),n.jsx("td",{className:"px-4 py-2 text-right",children:m(e.finalCount)}),n.jsx("td",{className:"px-4 py-2 text-right font-bold "+(0===e.difference?"text-slate-600":"text-red-600"),children:m(e.difference)})]},e.id))})]}),"FINANCIAL_STATEMENT"===c&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[n.jsxs("div",{className:"p-4 bg-emerald-50 rounded-lg text-center",children:[n.jsx("p",{className:"text-sm text-emerald-700",children:"Receitas"}),n.jsx("p",{className:"text-xl font-bold text-emerald-800",children:m(E.income||0)})]}),n.jsxs("div",{className:"p-4 bg-red-50 rounded-lg text-center",children:[n.jsx("p",{className:"text-sm text-red-700",children:"Despesas"}),n.jsx("p",{className:"text-xl font-bold text-red-800",children:m(E.expense||0)})]}),n.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg text-center",children:[n.jsx("p",{className:"text-sm text-blue-700",children:"Saldo"}),n.jsx("p",{className:"text-xl font-bold text-blue-800",children:m((E.income||0)-(E.expense||0))})]})]}),n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"text-xs text-slate-500 uppercase bg-slate-100",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left",children:"Data"}),n.jsx("th",{className:"px-4 py-2 text-left",children:"Descrição"}),n.jsx("th",{className:"px-4 py-2 text-right",children:"Valor"})]})}),n.jsx("tbody",{className:"divide-y divide-slate-100",children:I.map(e=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2",children:new Date(e.date).toLocaleDateString()}),n.jsx("td",{className:"px-4 py-2",children:e.description}),n.jsx("td",{className:"px-4 py-2 text-right font-bold "+("INCOME"===e.type?"text-emerald-600":"text-red-600"),children:m(e.amount)})]},e.id))})]})]})]})]})})]})]})};export{v as Reports};

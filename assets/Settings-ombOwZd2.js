var e=Object.defineProperty,a=Object.defineProperties,s=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(a,s,l)=>s in a?e(a,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[s]=l,i=(e,a)=>{for(var s in a||(a={}))t.call(a,s)&&o(e,s,a[s]);if(l)for(var s of l(a))r.call(a,s)&&o(e,s,a[s]);return e},n=(e,l)=>a(e,s(l)),c=(e,a,s)=>new Promise((l,t)=>{var r=e=>{try{i(s.next(e))}catch(a){t(a)}},o=e=>{try{i(s.throw(e))}catch(a){t(a)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(r,o);i((s=s.apply(e,a)).next())});import{c as d,s as x,r as m,S as p,A as u,j as h,d as g,b,B as f,C as j,I as v,U as y,k as N,o as C,Z as S}from"./index-CYX4AbMr.js";import{U as w,T as k}from"./upload-BDAbi9Lp.js";import{I as E,C as A}from"./image-CR8tJUAK.js";import{S as I}from"./search-CaOhx3f7.js";
/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=d("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]]),P=d("file-check",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]),U=d("file-lock",[["path",{d:"M4 9.8V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.706.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2h-3",key:"1432pc"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M9 17v-2a2 2 0 0 0-4 0v2",key:"168m41"}],["rect",{width:"8",height:"5",x:"3",y:"17",rx:"1",key:"o8vfew"}]]),M=d("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]),O=d("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]),R=d("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),D=d("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),L=d("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),T=d("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),F=e=>c(null,null,function*(){try{const a=e.name.split(".").pop(),s=`settings/${`logo-${Math.random().toString(36).substring(2)}.${a}`}`,{error:l}=yield x.storage.from("assets").upload(s,e);if(l)throw l;const{data:{publicUrl:t}}=x.storage.from("assets").getPublicUrl(s),{error:r}=yield x.from("settings").upsert({key:"app_logo_path",value:t,updated_at:(new Date).toISOString()},{onConflict:"key"});if(r)throw r;return{message:"Logo salva com sucesso!",path:t}}catch(a){throw console.error("Error uploading logo to Supabase:",a),new Error(a.message||"Falha no upload da logo.")}}),V=(e,a)=>c(null,null,function*(){try{const s=`certificates/${`certificate-${Date.now()}.pfx`}`,{error:l}=yield x.storage.from("assets").upload(s,e,{cacheControl:"3600",upsert:!0});if(l)throw l;const t=btoa(a),{error:r}=yield x.from("settings").upsert({key:"nfce_cert_password",value:t,updated_at:(new Date).toISOString()},{onConflict:"key"});if(r)throw r;const{error:o}=yield x.from("settings").upsert({key:"nfce_cert_path",value:s,updated_at:(new Date).toISOString()},{onConflict:"key"});if(o)throw o;return{message:"Certificado salvo com sucesso!"}}catch(s){throw console.error("Error uploading certificate:",s),new Error(s.message||"Falha no upload do certificado.")}}),H=()=>{const[e,a]=m.useState("COMPANY"),[s,l]=m.useState(null);m.useEffect(()=>{c(null,null,function*(){const e=yield p.getSettings();l(e)})},[]);const[t,r]=m.useState(!1),[o,d]=m.useState(!1),[x,H]=m.useState(null),[Y,q]=m.useState(""),[_,B]=m.useState([]),[J,G]=m.useState(!1),[$,K]=m.useState(null),[W,Z]=m.useState({name:"",email:"",password:"",role:"CASHIER"}),[Q,X]=m.useState([]),[ee,ae]=m.useState(""),[se,le]=m.useState({isOpen:!1,title:"",message:"",type:"info"}),[te,re]=m.useState({isOpen:!1,title:"",message:"",onConfirm:()=>{}});m.useEffect(()=>{"USERS"===e?oe():"SECURITY"===e&&ie()},[e]);const oe=()=>c(null,null,function*(){const e=yield p.getUsers();B(e)}),ie=()=>{X(u.getLogs())},ne=(e,a="Atenção",s="info")=>{le({isOpen:!0,message:e,title:a,type:s})},ce=[{id:"COMPANY",label:"Empresa",icon:h.jsx(z,{size:20})},{id:"FISCAL",label:"Fiscal (NFC-e)",icon:h.jsx(P,{size:20})},{id:"PAYMENT",label:"Pagamentos",icon:h.jsx(A,{size:20})},{id:"APPEARANCE",label:"Visual & PDV",icon:h.jsx(O,{size:20})},{id:"USERS",label:"Usuários",icon:h.jsx(y,{size:20})},{id:"SYNC",label:"Sincronização",icon:h.jsx(S,{size:20})},{id:"SECURITY",label:"Segurança & Auditoria",icon:h.jsx(L,{size:20})}],de=Q.filter(e=>e.details.toLowerCase().includes(ee.toLowerCase())||e.userName.toLowerCase().includes(ee.toLowerCase())||e.action.toLowerCase().includes(ee.toLowerCase()));return h.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-20",children:[h.jsx(g,{isOpen:se.isOpen,onClose:()=>le(e=>n(i({},e),{isOpen:!1})),title:se.title,message:se.message,type:se.type}),h.jsx(b,{isOpen:te.isOpen,onClose:()=>re(e=>n(i({},e),{isOpen:!1})),onConfirm:te.onConfirm,title:te.title,message:te.message,variant:"danger"}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Configurações do Sistema"}),h.jsx("p",{className:"text-slate-500",children:"Gerencie dados da empresa, emissão fiscal e personalização."})]}),"USERS"!==e&&"SECURITY"!==e&&h.jsxs(f,{onClick:()=>{r(!0),p.saveSettings(s),r(!1),ne("Configurações salvas com sucesso!","Sucesso","success")},disabled:t,className:"gap-2",children:[h.jsx(D,{size:18})," ",t?"Salvando...":"Salvar Alterações"]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[h.jsx("div",{className:"md:col-span-1 space-y-2",children:ce.map(s=>h.jsxs("button",{onClick:()=>a(s.id),className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-all "+(e===s.id?"bg-brand-50 text-brand-700 border border-brand-200 shadow-sm":"bg-white text-slate-600 hover:bg-slate-50 border border-transparent"),children:[s.icon,s.label]},s.id))}),h.jsx("div",{className:"md:col-span-3",children:s?h.jsxs(j,{children:["COMPANY"===e&&h.jsxs("div",{className:"space-y-5 animate-fadeIn",children:[h.jsx("h3",{className:"text-lg font-bold border-b border-slate-100 pb-2",children:"Dados da Empresa"}),h.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[h.jsx(v,{label:"Razão Social",value:s.company.corporateName,onChange:e=>l(n(i({},s),{company:n(i({},s.company),{corporateName:e.target.value})}))}),h.jsx(v,{label:"Nome Fantasia",value:s.company.fantasyName,onChange:e=>l(n(i({},s),{company:n(i({},s.company),{fantasyName:e.target.value})}))})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsx(v,{label:"CNPJ",value:s.company.cnpj,onChange:e=>l(n(i({},s),{company:n(i({},s.company),{cnpj:e.target.value})})),placeholder:"00.000.000/0000-00"}),h.jsx(v,{label:"Inscrição Estadual (IE)",value:s.company.ie,onChange:e=>l(n(i({},s),{company:n(i({},s.company),{ie:e.target.value})}))})]}),h.jsxs("div",{className:"flex flex-col gap-1",children:[h.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Regime Tributário"}),h.jsxs("select",{className:"border border-slate-300 rounded-md p-2 bg-white",value:s.company.taxRegime,onChange:e=>l(n(i({},s),{company:n(i({},s.company),{taxRegime:e.target.value})})),children:[h.jsx("option",{value:"1",children:"1 - Simples Nacional"}),h.jsx("option",{value:"3",children:"3 - Regime Normal"})]})]}),h.jsx(v,{label:"Endereço Completo",value:s.company.address,onChange:e=>l(n(i({},s),{company:n(i({},s.company),{address:e.target.value})}))}),h.jsx(v,{label:"Telefone",value:s.company.phone,onChange:e=>l(n(i({},s),{company:n(i({},s.company),{phone:e.target.value})}))})]}),"FISCAL"===e&&h.jsxs("div",{className:"space-y-5 animate-fadeIn",children:[h.jsxs("h3",{className:"text-lg font-bold border-b border-slate-100 pb-2 flex items-center gap-2",children:[h.jsx(P,{className:"text-brand-600"})," Configuração NFC-e"]}),h.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200 text-sm text-amber-800 mb-4",children:[h.jsx("p",{className:"font-bold",children:"⚠️ Atenção"}),h.jsx("p",{children:"Certifique-se de usar o CSC (Código de Segurança do Contribuinte) correto obtido no portal da SEFAZ do seu estado."})]}),h.jsxs("div",{className:"flex flex-col gap-1",children:[h.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Ambiente de Emissão"}),h.jsxs("select",{className:"border border-slate-300 rounded-md p-2 bg-white font-medium",value:s.fiscal.environment,onChange:e=>l(n(i({},s),{fiscal:n(i({},s.fiscal),{environment:e.target.value})})),children:[h.jsx("option",{value:"2",children:"Homologação (Testes)"}),h.jsx("option",{value:"1",children:"Produção (Validade Jurídica)"})]})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsx(v,{label:"Série NFC-e",type:"number",value:s.fiscal.nfceSeries,onChange:e=>l(n(i({},s),{fiscal:n(i({},s.fiscal),{nfceSeries:parseInt(e.target.value)})}))}),h.jsx(v,{label:"ID do CSC (Token ID)",value:s.fiscal.cscId,onChange:e=>l(n(i({},s),{fiscal:n(i({},s.fiscal),{cscId:e.target.value})})),placeholder:"Ex: 000001"})]}),h.jsx(v,{label:"Código CSC (Token)",value:s.fiscal.cscToken,onChange:e=>l(n(i({},s),{fiscal:n(i({},s.fiscal),{cscToken:e.target.value})})),placeholder:"Ex: A1B2C3D4..."}),h.jsxs("div",{className:"!mt-8 pt-6 border-t-2 border-dashed border-slate-200 space-y-4",children:[h.jsxs("h4",{className:"text-md font-bold text-slate-800 flex items-center gap-2",children:[h.jsx(U,{size:20})," Certificado Digital A1"]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 uppercase mb-1",children:"Arquivo do Certificado (.pfx)"}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("label",{htmlFor:"cert-upload",className:"cursor-pointer inline-flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-md font-medium transition border border-slate-300",children:[h.jsx(w,{size:18})," Selecionar Arquivo"]}),h.jsx("input",{type:"file",id:"cert-upload",className:"hidden",accept:".pfx",onChange:e=>{var a;const s=null==(a=e.target.files)?void 0:a[0];s&&s.name.endsWith(".pfx")?H(s):(ne("Por favor, selecione um arquivo .pfx válido.","Erro","error"),H(null),e.target.value="")}}),h.jsx("span",{className:"text-sm text-slate-500",children:x?x.name:"Nenhum arquivo selecionado."})]})]}),h.jsx(v,{label:"Senha do Certificado",type:"password",value:Y,onChange:e=>q(e.target.value),placeholder:"Digite a senha do seu certificado",icon:h.jsx(M,{size:18})}),h.jsxs(f,{onClick:()=>c(null,null,function*(){if(!x)return ne("Nenhum arquivo de certificado selecionado.","Erro","error");if(!Y)return ne("Por favor, informe a senha do certificado.","Erro","error");d(!0);try{const e=yield V(x,Y);ne(e.message||"Certificado salvo com sucesso!","Sucesso","success"),H(null),q("");const a=document.getElementById("cert-upload");a&&(a.value="")}catch(e){ne(e.message||"Ocorreu um erro ao salvar o certificado.","Erro","error")}finally{d(!1)}}),disabled:o,className:"gap-2 bg-blue-600 hover:bg-blue-700 text-white",children:[h.jsx(D,{size:18})," ",o?"Salvando...":"Salvar Certificado e Senha"]})]})]}),"PAYMENT"===e&&h.jsxs("div",{className:"space-y-5 animate-fadeIn",children:[h.jsx("h3",{className:"text-lg font-bold border-b border-slate-100 pb-2",children:"Configurações de Recebimento"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("h4",{className:"font-bold text-slate-700 flex items-center gap-2",children:[h.jsx("div",{className:"w-6 h-6 bg-brand-600 rounded flex items-center justify-center text-white text-xs font-bold",children:"PIX"}),"Chave Pix Principal"]}),h.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[h.jsxs("div",{className:"flex flex-col gap-1 col-span-1",children:[h.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Tipo de Chave"}),h.jsxs("select",{className:"border border-slate-300 rounded-md p-2 bg-white",value:s.payment.pixKeyType,onChange:e=>l(n(i({},s),{payment:n(i({},s.payment),{pixKeyType:e.target.value})})),children:[h.jsx("option",{value:"CNPJ",children:"CNPJ"}),h.jsx("option",{value:"CPF",children:"CPF"}),h.jsx("option",{value:"EMAIL",children:"E-mail"}),h.jsx("option",{value:"PHONE",children:"Telefone"}),h.jsx("option",{value:"RANDOM",children:"Aleatória"})]})]}),h.jsx("div",{className:"col-span-2",children:h.jsx(v,{label:"Chave Pix",value:s.payment.pixKey,onChange:e=>l(n(i({},s),{payment:n(i({},s.payment),{pixKey:e.target.value})}))})})]}),h.jsx("p",{className:"text-xs text-slate-500",children:"Esta chave será utilizada para gerar o QR Code no PDV."})]})]}),"APPEARANCE"===e&&h.jsxs("div",{className:"space-y-5 animate-fadeIn",children:[h.jsx("h3",{className:"text-lg font-bold border-b border-slate-100 pb-2",children:"Personalização Visual"}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Logomarca da Empresa"}),h.jsxs("div",{className:"flex items-start gap-6",children:[h.jsx("div",{className:"w-40 h-40 border-2 border-dashed border-slate-300 rounded-lg flex items-center justify-center bg-slate-50 overflow-hidden relative",children:s.appearance.logoUrl?h.jsx("img",{src:s.appearance.logoUrl,alt:"Logo",className:"w-full h-full object-contain"}):h.jsxs("div",{className:"text-slate-400 flex flex-col items-center",children:[h.jsx(E,{size:32,className:"mb-2"}),h.jsx("span",{className:"text-xs",children:"Sem Logo"})]})}),h.jsxs("div",{className:"flex-1 space-y-3",children:[h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:"file",id:"logo-upload",className:"hidden",accept:"image/png, image/jpeg",onChange:e=>c(null,null,function*(){var a;const s=null==(a=e.target.files)?void 0:a[0];if(s){if(s.size>2097152)return void ne("A imagem é muito grande. O limite é 2MB.","Erro","error");r(!0);try{const e=yield F(s);ne("Logo salva com sucesso!","Sucesso","success"),l(a=>n(i({},a),{appearance:n(i({},a.appearance),{logoUrl:e.path})}))}catch(t){ne(t.message||"Erro ao fazer upload da logo.","Erro","error")}finally{r(!1)}}})}),h.jsxs("label",{htmlFor:"logo-upload",className:"cursor-pointer inline-flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-md font-medium transition",children:[h.jsx(w,{size:18})," Carregar Imagem"]})]}),s.appearance.logoUrl&&h.jsxs("button",{onClick:()=>l(e=>n(i({},e),{appearance:n(i({},e.appearance),{logoUrl:null})})),title:"Remover logo atual",className:"flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-md transition text-sm font-medium",children:[h.jsx(k,{size:16})," Remover Logo"]}),h.jsxs("p",{className:"text-xs text-slate-500",children:["Recomendado: PNG ou JPG com fundo transparente. Máx 2MB.",h.jsx("br",{}),"Esta imagem aparecerá como marca d'água no fundo do carrinho do PDV."]})]})]})]})]}),"USERS"===e&&h.jsxs("div",{className:"space-y-5 animate-fadeIn",children:[h.jsxs("div",{className:"flex justify-between items-center border-b border-slate-100 pb-2",children:[h.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[h.jsx(y,{className:"text-brand-600"})," Gerenciamento de Usuários"]}),h.jsxs(f,{onClick:()=>{K(null),Z({name:"",email:"",password:"",role:"CASHIER"}),G(!0)},children:[h.jsx(T,{size:18})," Novo Usuário"]})]}),h.jsx("div",{className:"overflow-hidden border border-slate-200 rounded-lg",children:h.jsxs("table",{className:"w-full text-sm text-left",children:[h.jsx("thead",{className:"bg-slate-50 text-slate-500 uppercase text-xs font-bold",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3",children:"Nome"}),h.jsx("th",{className:"px-6 py-3",children:"Email / Login"}),h.jsx("th",{className:"px-6 py-3",children:"Função"}),h.jsx("th",{className:"px-6 py-3 text-right",children:"Ações"})]})}),h.jsx("tbody",{className:"divide-y divide-slate-100 bg-white",children:_.map(e=>h.jsxs("tr",{className:"hover:bg-slate-50 transition",children:[h.jsx("td",{className:"px-6 py-4 font-medium text-slate-800",children:e.name}),h.jsx("td",{className:"px-6 py-4 text-slate-500",children:e.email}),h.jsx("td",{className:"px-6 py-4",children:"ADMIN"===e.role?h.jsx(N,{color:"bg-blue-100 text-blue-700",children:"Administrador"}):h.jsx(N,{color:"bg-emerald-100 text-emerald-700",children:"Operador de Caixa"})}),h.jsx("td",{className:"px-6 py-4 text-right",children:h.jsxs("div",{className:"flex justify-end gap-2",children:[h.jsx("button",{onClick:()=>{return K(a=e),Z({name:a.name,email:a.email,password:a.password,role:a.role}),void G(!0);var a},title:"Editar usuário",className:"p-2 text-slate-400 hover:text-brand-600 hover:bg-brand-50 rounded transition",children:h.jsx(R,{size:16})}),h.jsx("button",{onClick:()=>(e=>{if(_.length<=1)return ne("Não é possível excluir o único usuário do sistema.","Erro","error");re({isOpen:!0,title:"Excluir Usuário",message:"Tem certeza que deseja excluir este usuário? Esta ação não pode ser desfeita.",onConfirm:()=>{p.deleteUser(e),oe(),ne("Usuário excluído.","Sucesso","success")}})})(e.id),title:"Excluir usuário",className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded transition",children:h.jsx(k,{size:16})})]})})]},e.id))})]})})]}),"SYNC"===e&&h.jsx("div",{className:"animate-fadeIn",children:h.jsx(C,{})}),"SECURITY"===e&&h.jsxs("div",{className:"space-y-5 animate-fadeIn",children:[h.jsxs("div",{className:"flex justify-between items-center border-b border-slate-100 pb-2",children:[h.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[h.jsx(L,{className:"text-slate-600"})," Auditoria e Logs do Sistema"]}),h.jsxs("div",{className:"relative",children:[h.jsx(I,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),h.jsx("input",{className:"pl-9 pr-4 py-2 text-sm border border-slate-300 rounded-md focus:outline-none focus:border-brand-500",placeholder:"Buscar logs...",value:ee,onChange:e=>ae(e.target.value)})]})]}),h.jsx("div",{className:"overflow-hidden border border-slate-200 rounded-lg",children:h.jsxs("table",{className:"w-full text-sm text-left",children:[h.jsx("thead",{className:"bg-slate-50 text-slate-500 uppercase text-xs font-bold",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3",children:"Data/Hora"}),h.jsx("th",{className:"px-6 py-3",children:"Usuário"}),h.jsx("th",{className:"px-6 py-3",children:"Ação"}),h.jsx("th",{className:"px-6 py-3",children:"Detalhes"}),h.jsx("th",{className:"px-6 py-3 text-right",children:"Nível"})]})}),h.jsxs("tbody",{className:"divide-y divide-slate-100 bg-white",children:[de.map(e=>h.jsxs("tr",{className:"hover:bg-slate-50 transition",children:[h.jsx("td",{className:"px-6 py-4 text-slate-500 font-mono text-xs",children:new Date(e.timestamp).toLocaleString()}),h.jsxs("td",{className:"px-6 py-4 font-medium text-slate-800",children:[e.userName," ",h.jsxs("span",{className:"text-slate-400 text-xs",children:["(",e.userRole,")"]})]}),h.jsx("td",{className:"px-6 py-4",children:h.jsx("span",{className:"font-bold text-xs bg-slate-100 px-2 py-1 rounded text-slate-600",children:e.action})}),h.jsx("td",{className:"px-6 py-4 text-slate-600 truncate max-w-xs",title:e.details,children:e.details}),h.jsxs("td",{className:"px-6 py-4 text-right",children:["CRITICAL"===e.severity&&h.jsx(N,{color:"bg-red-100 text-red-700",children:"Crítico"}),"WARNING"===e.severity&&h.jsx(N,{color:"bg-amber-100 text-amber-700",children:"Atenção"}),"INFO"===e.severity&&h.jsx(N,{color:"bg-blue-50 text-blue-600",children:"Info"})]})]},e.id)),0===de.length&&h.jsx("tr",{children:h.jsx("td",{colSpan:5,className:"p-8 text-center text-slate-400",children:"Nenhum registro de auditoria encontrado."})})]})]})})]})]}):h.jsx(j,{children:h.jsx("div",{className:"flex items-center justify-center py-20",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-600 mx-auto mb-4"}),h.jsx("p",{className:"text-slate-600",children:"Carregando configurações..."})]})})})})]}),J&&h.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md p-6 shadow-2xl animate-scaleIn",children:[h.jsxs("h3",{className:"text-xl font-bold text-slate-800 mb-6 flex items-center gap-2",children:[$?h.jsx(R,{size:20}):h.jsx(T,{size:20}),$?"Editar Usuário":"Novo Usuário"]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(v,{label:"Nome Completo",value:W.name,onChange:e=>Z(n(i({},W),{name:e.target.value})),placeholder:"Ex: João da Silva"}),h.jsx(v,{label:"Email / Login",value:W.email,onChange:e=>Z(n(i({},W),{email:e.target.value})),placeholder:"usuario@sistema.com"}),h.jsx(v,{label:"Senha",type:"text",value:W.password,onChange:e=>Z(n(i({},W),{password:e.target.value})),placeholder:"******"}),h.jsxs("div",{className:"flex flex-col gap-1",children:[h.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Nível de Acesso"}),h.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[h.jsxs("button",{type:"button",onClick:()=>Z(n(i({},W),{role:"ADMIN"})),title:"Selecionar função Administrador",className:"p-3 rounded-lg border-2 flex flex-col items-center gap-2 transition "+("ADMIN"===W.role?"border-blue-500 bg-blue-50 text-blue-700":"border-slate-200 text-slate-500 hover:bg-slate-50"),children:[h.jsx(L,{size:20}),h.jsx("span",{className:"text-sm font-bold",children:"Administrador"})]}),h.jsxs("button",{type:"button",onClick:()=>Z(n(i({},W),{role:"CASHIER"})),title:"Selecionar função Operador de Caixa",className:"p-3 rounded-lg border-2 flex flex-col items-center gap-2 transition "+("CASHIER"===W.role?"border-emerald-500 bg-emerald-50 text-emerald-700":"border-slate-200 text-slate-500 hover:bg-slate-50"),children:[h.jsx(A,{size:20}),h.jsx("span",{className:"text-sm font-bold",children:"Caixa"})]})]})]})]}),h.jsxs("div",{className:"mt-8 flex justify-end gap-3",children:[h.jsx(f,{variant:"secondary",onClick:()=>G(!1),children:"Cancelar"}),h.jsx(f,{onClick:()=>{if(!W.name||!W.email||!W.password)return ne("Preencha todos os campos obrigatórios.");const e=i({id:$?$.id:crypto.randomUUID()},W);p.saveUser(e),G(!1),K(null),Z({name:"",email:"",password:"",role:"CASHIER"}),oe(),ne($?"Usuário atualizado!":"Usuário criado com sucesso!","Sucesso","success")},children:"Salvar Usuário"})]})]})})]})};export{H as Settings};
